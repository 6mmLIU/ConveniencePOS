<!-- src/main/resources/templates/auth/payment_select_batch.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head>
    <meta charset="UTF-8"/>
    <title>购物车结算</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="container py-4">
<h2 class="mb-4">订单确认</h2>
<form th:action="@{/payments/processBatch}" method="post">
    <!-- CSRF 隐藏域 -->
<!--    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
    <!-- saleId -->
    <input type="hidden" name="saleId" th:value="${saleId}"/>

    <table class="table table-bordered">
        <thead>
        <tr>
            <th>商品</th>
            <th>单价（元）</th>
            <th>数量</th>
            <th>小计（元）</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="item : ${items}">
            <td>
                <span th:text="${item.name}">商品名</span>
                <!-- productId 隐藏域 -->
                <input type="hidden" name="productId" th:value="${item.productId}"/>
            </td>
            <td>
                <span th:text="${item.price}">0.00</span>
            </td>
            <td>
                <span th:text="${item.quantity}">1</span>
                <!-- quantity 隐藏域 -->
                <input type="hidden" name="quantity" th:value="${item.quantity}"/>
            </td>
            <td>
                <span th:text="${item.lineTotal}">0.00</span>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="text-end fw-bold">总计：</td>
            <td class="fw-bold" th:text="${total}">0.00</td>
        </tr>
        </tbody>
    </table>

    <div class="mb-3">
        <label class="form-label fw-bold">支付方式：</label>
        <select class="form-select w-auto d-inline-block" name="method">
            <option th:each="m : ${methods}"
                    th:value="${m}"
                    th:text="${m}">CASH</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">去支付</button>
</form>
</body>
</html>
